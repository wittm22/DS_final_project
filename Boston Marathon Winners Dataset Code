import pandas as pd
import numpy as np
import matplotlib as mpl
import matplotlib.pyplot as plt
%matplotlib inline
import seaborn; seaborn.set()

#converts 'string' value of men's marathon winning times into 'timedelta' objects
from datetime import datetime, timedelta

def convert_time(s):
    h, m, s = map(int, s.split(':'))
    return timedelta(hours=h, minutes=m, seconds=s)

mens_data = pd.read_csv('Mens_Boston_Marathon_Winners.csv',
                   converters={'Time':convert_time})
mens_data.head() #prints attributes of first five rows

#converts time into an 'int' object. 'Time_hours' represents the men's finishing times in hours.
mens_data['Time_hours'] = mens_data['Time'].astype(int) / 1E9 * (1/3600)
mens_data.head()

mens_year = mens_data['Year']
mens_time = mens_data['Time_hours']

plt.scatter(mens_year, mens_time); #scatterplot of men's marathon times from 1897 to 2022
plt.xlabel('Year')
plt.ylabel('Finish Time (Hours)')
plt.title("Men's Boston Marathon Winning Finishing Times (1897-2023)")
plt.show()

#prints scatterplot with line of best fit
from sklearn.linear_model import LinearRegression
mens_model = LinearRegression(fit_intercept = True)
mens_model.fit(mens_year[:, np.newaxis], mens_time)
mens_xfit = np.linspace(1897, 2023)
mens_yfit = mens_model.predict(mens_xfit[:, np.newaxis])

plt.scatter(mens_year, mens_time)
plt.plot(mens_xfit, mens_yfit)
plt.xlabel("Year")
plt.ylabel("Finish Time (Hours)")
plt.title("Men's Boston Marathon Winners Finishing Times (1897 - 2023)")

print("Model slope: ", mens_model.coef_[0], "hours")
print("Model intercept: ", mens_model.intercept_, "hours")
print("Line of Best Fit Equation: y =", mens_model.coef_[0], "* x +", mens_model.intercept_)


